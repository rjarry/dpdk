v3: replaced memcpy with struct assignment
